以下のコードに対してリファクタリングを提案してください：

コード: $ARGUMENTS

## リファクタリング重点項目:
1. 関数型プログラミングへの変換
2. Result型の適用
3. 単一責任原則の適用
4. 可読性の向上
5. パフォーマンスの最適化

各変更について理由を説明し、before/afterのコードを提示してください。
